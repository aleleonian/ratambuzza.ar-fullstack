<!-- Lightbox Modal (initially hidden) -->
<div id="lightbox" class="lightbox hidden">
  <button id="lightbox-close" class="lightbox-close" aria-label="Cerrar">&times;</button>
  <img id="lightbox-image" class="lightbox-image" src="" alt="Expanded media" />
  <div class="lightbox-controls">
    <button id="lightbox-prev">⬅️</button>
    <button id="lightbox-download">⬇️</button>
    <button id="lightbox-like">❤️</button>
    <button id="lightbox-next">➡️</button>
  </div>
</div>

<style>
  .lightbox {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.9);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    z-index: 9999;
  }

  .lightbox.hidden {
    display: none;
  }

  .lightbox-image {
    max-width: 90vw;
    max-height: 80vh;
    object-fit: contain;
    border: 4px solid white;
    border-radius: 8px;
  }

  .lightbox-controls {
    margin-top: 1rem;
    display: flex;
    gap: 1rem;
  }

  .lightbox-controls button,
  .lightbox-close {
    background: rgba(255, 255, 255, 0.1);
    border: 2px solid white;
    color: white;
    padding: 0.5rem 1rem;
    font-size: 1.25rem;
    cursor: pointer;
    border-radius: 6px;
  }

  .lightbox-close {
    position: absolute;
    top: 1rem;
    right: 1rem;
    font-size: 2rem;
  }
</style>

<script>
  const lightbox = document.getElementById('lightbox');
  const lightboxImg = document.getElementById('lightbox-image');
  const closeBtn = document.getElementById('lightbox-close');
  const prevBtn = document.getElementById('lightbox-prev');
  const nextBtn = document.getElementById('lightbox-next');
  const downloadBtn = document.getElementById('lightbox-download');
  const likeBtn = document.getElementById('lightbox-like');

  const galleryItems = document.querySelectorAll('.gallery-item');
  let currentIndex = 0;

  function openLightbox(index) {
    const item = galleryItems[index];
    const fullRes = item.getAttribute('href');
    lightboxImg.src = fullRes;
    lightbox.classList.remove('hidden');
    currentIndex = index;
  }

  function closeLightbox() {
    lightbox.classList.add('hidden');
    lightboxImg.src = '';
  }

  function showNext() {
    if (currentIndex + 1 < galleryItems.length) openLightbox(currentIndex + 1);
  }

  function showPrev() {
    if (currentIndex - 1 >= 0) openLightbox(currentIndex - 1);
  }

  galleryItems.forEach((item, index) => {
    item.addEventListener('click', (e) => {
      e.preventDefault();
      openLightbox(index);
    });
  });

  closeBtn.addEventListener('click', closeLightbox);
  nextBtn.addEventListener('click', showNext);
  prevBtn.addEventListener('click', showPrev);
  downloadBtn.addEventListener('click', () => {
    const link = document.createElement('a');
    link.href = lightboxImg.src;
    link.download = '';
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
  });

  document.addEventListener('keydown', (e) => {
    if (lightbox.classList.contains('hidden')) return;
    if (e.key === 'Escape') closeLightbox();
    if (e.key === 'ArrowRight') showNext();
    if (e.key === 'ArrowLeft') showPrev();
  });
</script>
